{
	"extends": [
		"next/core-web-vitals",
		"plugin:@typescript-eslint/recommended",
		"plugin:import/recommended",
		"plugin:import/typescript",
		"plugin:jsx-a11y/recommended",
		"plugin:react/recommended",
		"plugin:react-hooks/recommended"
	],
	"parser": "@typescript-eslint/parser",
	"parserOptions": {
		"ecmaVersion": 2022,
		"sourceType": "module",
		"ecmaFeatures": {
			"jsx": true
		},
		"project": "./tsconfig.json"
	},
	"plugins": ["@typescript-eslint", "import", "jsx-a11y", "react", "react-hooks"],
	"settings": {
		"react": {
			"version": "detect"
		},
		"import/resolver": {
			"typescript": {
				"alwaysTryTypes": true,
				"project": "./tsconfig.json"
			},
			"node": {
				"extensions": [".js", ".jsx", ".ts", ".tsx"]
			}
		},
		"import/parsers": {
			"@typescript-eslint/parser": [".ts", ".tsx"]
		}
	},
	"rules": {
		// ==========================================
		// BARREL EXPORT ENFORCEMENT (FAANG-Level)
		// ==========================================
		
		// Enforce barrel imports from aliased paths
		"no-restricted-imports": [
			"error",
			{
				"patterns": [
					{
						"group": ["../../../*", "../../../../*", "../../../../../*"],
						"message": "‚ùå Deep relative imports (3+ levels) are forbidden.\n‚úÖ Use barrel exports with path aliases:\n  ‚Ä¢ @_features/feature-name\n  ‚Ä¢ @_shared\n  ‚Ä¢ @_lib\n  ‚Ä¢ @_core\n  ‚Ä¢ @_components/*\n  ‚Ä¢ @_classes/*\n  ‚Ä¢ @_types\n  ‚Ä¢ @_helpers/*"
					},
					{
						"group": ["**/index"],
						"message": "‚ùå Do not import 'index' explicitly.\n‚úÖ Import from the parent directory barrel instead."
					},
					{
						"group": ["app/_features/*/services/*", "!app/_features/*/index*"],
						"message": "‚ùå Do not import feature services directly.\n‚úÖ Import from feature barrel: import { ServiceName } from '@_features/feature-name'"
					},
					{
						"group": ["app/_features/*/stores/*", "!app/_features/*/index*"],
						"message": "‚ùå Do not import feature stores directly.\n‚úÖ Import from feature barrel: import { useStoreName } from '@_features/feature-name'"
					},
					{
						"group": ["app/_features/*/hooks/*", "!app/_features/*/index*"],
						"message": "‚ùå Do not import feature hooks directly.\n‚úÖ Import from feature barrel: import { useHookName } from '@_features/feature-name'"
					},
					{
						"group": ["app/_shared/hooks/*", "!app/_shared/index*"],
						"message": "‚ùå Do not import shared hooks directly.\n‚úÖ Import from @_shared barrel: import { useHookName } from '@_shared'"
					},
					{
						"group": ["app/_shared/services/*", "!app/_shared/index*"],
						"message": "‚ùå Do not import shared services directly.\n‚úÖ Import from @_shared barrel: import { ServiceName, API } from '@_shared'"
					},
					{
						"group": ["app/_shared/utils/*", "!app/_shared/index*"],
						"message": "‚ùå Do not import shared utils directly.\n‚úÖ Import from @_shared barrel: import { utilityName } from '@_shared'"
					},
					{
						"group": ["app/_lib/formatters/*", "app/_lib/dates/*", "app/_lib/validators/*", "!app/_lib/index*"],
						"message": "‚ùå Do not import lib utilities directly.\n‚úÖ Import from @_lib barrel: import { formatCurrency, formatDate } from '@_lib'"
					},
					{
						"group": ["app/_core/logger/*", "app/_core/validation/*", "!app/_core/index*"],
						"message": "‚ùå Do not import core utilities directly.\n‚úÖ Import from @_core barrel: import { Logger } from '@_core'"
					}
				]
			}
		],

		// Prevent circular dependencies (CRITICAL for large codebases)
		// NOTE: Domain classes (Company, User, Order, Quote) have intentional cycles
		// for bidirectional relationships - this is acceptable for domain models
		"import/no-cycle": [
			"error",
			{
				"maxDepth": 10,
				"ignoreExternal": true,
				"allowUnsafeDynamicCyclicDependency": false
			}
		],

		// Enforce consistent import order (Meta/Google/Netflix standard)
		"import/order": [
			"error",
			{
				"groups": [
					"builtin",
					"external",
					"internal",
					"parent",
					"sibling",
					"index",
					"type"
				],
				"pathGroups": [
					{
						"pattern": "react",
						"group": "external",
						"position": "before"
					},
					{
						"pattern": "react-dom",
						"group": "external",
						"position": "before"
					},
					{
						"pattern": "next",
						"group": "external",
						"position": "before"
					},
					{
						"pattern": "next/**",
						"group": "external",
						"position": "before"
					},
					{
						"pattern": "@_features/**",
						"group": "internal",
						"position": "before"
					},
					{
						"pattern": "@_core",
						"group": "internal",
						"position": "before"
					},
					{
						"pattern": "@_core/**",
						"group": "internal",
						"position": "before"
					},
					{
						"pattern": "@_lib",
						"group": "internal",
						"position": "before"
					},
					{
						"pattern": "@_lib/**",
						"group": "internal",
						"position": "before"
					},
					{
						"pattern": "@_shared",
						"group": "internal",
						"position": "before"
					},
					{
						"pattern": "@_shared/**",
						"group": "internal",
						"position": "before"
					},
					{
						"pattern": "@_classes/**",
						"group": "internal",
						"position": "after"
					},
					{
						"pattern": "@_components/**",
						"group": "internal",
						"position": "after"
					},
					{
						"pattern": "@_types",
						"group": "internal",
						"position": "after"
					},
					{
						"pattern": "@_types/**",
						"group": "internal",
						"position": "after"
					},
					{
						"pattern": "@_helpers/**",
						"group": "internal",
						"position": "after"
					}
				],
				"pathGroupsExcludedImportTypes": ["react", "react-dom", "next"],
				"newlines-between": "always",
				"alphabetize": {
					"order": "asc",
					"caseInsensitive": true
				}
			}
		],

		// Ensure all imports can be resolved
		"import/no-unresolved": "error",

		// Prefer named exports for better tree-shaking (disabled for Next.js pages)
		"import/prefer-default-export": "off",

		// Prevent namespace imports for better tree-shaking
		"import/no-namespace": [
			"warn",
			{
				"ignore": ["lucide-react"]
			}
		],

		// ==========================================
		// TYPESCRIPT BEST PRACTICES
		// ==========================================
		
		"@typescript-eslint/no-unused-vars": [
			"error",
			{
				"argsIgnorePattern": "^_",
				"varsIgnorePattern": "^_",
				"caughtErrorsIgnorePattern": "^_",
				"destructuredArrayIgnorePattern": "^_"
			}
		],
		"@typescript-eslint/no-explicit-any": "warn",
		"@typescript-eslint/explicit-module-boundary-types": "off",
		"@typescript-eslint/no-non-null-assertion": "warn",
		
		// Enforce consistent type imports (Google/Airbnb standard)
		"@typescript-eslint/consistent-type-imports": [
			"error",
			{
				"prefer": "type-imports",
				"disallowTypeAnnotations": false,
				"fixStyle": "separate-type-imports"
			}
		],

		// Enforce consistent type exports
		// NOTE: This is a type-aware rule - disabled for performance
		// Enable if you add parserOptions.project and need strict type export checking
		// "@typescript-eslint/consistent-type-exports": [
		// 	"error",
		// 	{
		// 		"fixMixedExportsWithInlineTypeSpecifier": true
		// 	}
		// ],

		// Prevent unused imports
		"@typescript-eslint/no-unused-expressions": [
			"error",
			{
				"allowShortCircuit": true,
				"allowTernary": true,
				"allowTaggedTemplates": true
			}
		],

		// ==========================================
		// NEXT.JS SPECIFIC
		// ==========================================
		
		"@next/next/no-html-link-for-pages": "error",
		"@next/next/no-img-element": "warn",

		// ==========================================
		// CODE QUALITY
		// ==========================================
		
		"no-console": [
			"warn",
			{
				"allow": ["warn", "error"]
			}
		],
		"prefer-const": "error",
		"no-var": "error",
		"eqeqeq": ["error", "always", { "null": "ignore" }],
		"curly": ["error", "all"],
		"no-debugger": "warn",
		"no-unreachable": "error",

		// ==========================================
		// PHASE 8: ASYNC/PROMISE SAFETY (CRITICAL)
		// ==========================================
		
		// Prevent floating promises (unhandled async operations)
		"@typescript-eslint/no-floating-promises": [
			"error",
			{
				"ignoreVoid": true,
				"ignoreIIFE": false
			}
		],
		
		// Prevent misuse of promises (e.g., in if statements)
		"@typescript-eslint/no-misused-promises": [
			"error",
			{
				"checksConditionals": true,
				"checksVoidReturn": {
					"arguments": true,
					"attributes": true,
					"properties": true,
					"returns": true,
					"variables": true
				}
			}
		],
		
		// Require await in async functions
		"require-await": "off",
		"@typescript-eslint/require-await": "warn",
		
		// Prevent async functions in places that don't handle promises
		"@typescript-eslint/promise-function-async": [
			"warn",
			{
				"allowedPromiseNames": ["Thenable"],
				"checkArrowFunctions": true,
				"checkFunctionDeclarations": true,
				"checkFunctionExpressions": true,
				"checkMethodDeclarations": true
			}
		],
		
		// Ensure proper handling of returned promises
		"@typescript-eslint/no-misused-new": "error",
		
		// Return await only in try-catch blocks
		"no-return-await": "off",
		"@typescript-eslint/return-await": ["error", "in-try-catch"],

		// ==========================================
		// PHASE 8: NAMING CONVENTIONS (FAANG)
		// ==========================================
		
		"@typescript-eslint/naming-convention": [
			"warn",
			// Default: camelCase for variables, functions
			{
				"selector": "default",
				"format": ["camelCase"],
				"leadingUnderscore": "allow",
				"trailingUnderscore": "forbid"
			},
			
			// Imports: Allow PascalCase for class/type imports, camelCase for functions
			{
				"selector": "import",
				"format": ["camelCase", "PascalCase", "UPPER_CASE"]
			},
			
			// Variables: camelCase or UPPER_CASE for constants or PascalCase for classes
			{
				"selector": "variable",
				"format": ["camelCase", "UPPER_CASE", "PascalCase"],
				"leadingUnderscore": "allow"
			},
			
			// Functions: camelCase (including React hooks) or PascalCase for components
			{
				"selector": "function",
				"format": ["camelCase", "PascalCase"]
			},
			
			// Parameters: camelCase, allow leading underscore for unused
			{
				"selector": "parameter",
				"format": ["camelCase"],
				"leadingUnderscore": "allow"
			},
			
			// Class members: camelCase or PascalCase for nested classes/constants
			{
				"selector": "memberLike",
				"format": ["camelCase", "PascalCase"],
				"leadingUnderscore": "allow"
			},
			
			// Types/Interfaces: PascalCase
			{
				"selector": "typeLike",
				"format": ["PascalCase"]
			},
			
			// Enums: PascalCase
			{
				"selector": "enum",
				"format": ["PascalCase"]
			},
			
			// Enum members: PascalCase or UPPER_CASE
			{
				"selector": "enumMember",
				"format": ["PascalCase", "UPPER_CASE"]
			},
			
			// Classes: PascalCase
			{
				"selector": "class",
				"format": ["PascalCase"]
			},
			
			// Interfaces: PascalCase (no 'I' prefix allowed except ILogger)
			{
				"selector": "interface",
				"format": ["PascalCase"],
				"custom": {
					"regex": "^I[A-Z]",
					"match": false
				}
			},
			
			// Type aliases: PascalCase
			{
				"selector": "typeAlias",
				"format": ["PascalCase"]
			}
		],

		// ==========================================
		// PHASE 8: TYPESCRIPT STRICTNESS
		// ==========================================
		
		// Prefer nullish coalescing (??) over logical OR (||)
		"@typescript-eslint/prefer-nullish-coalescing": [
			"warn",
			{
				"ignoreConditionalTests": false,
				"ignoreTernaryTests": false,
				"ignoreMixedLogicalExpressions": true
			}
		],
		
		// Prefer optional chaining (?.) over manual checks
		"@typescript-eslint/prefer-optional-chain": "error",
		
		// Disallow unnecessary type assertions
		"@typescript-eslint/no-unnecessary-type-assertion": "warn",
		
		// Prevent unsafe operations (warn, not error, as we have legitimate uses)
		"@typescript-eslint/no-unsafe-member-access": "off",
		"@typescript-eslint/no-unsafe-assignment": "off",
		"@typescript-eslint/no-unsafe-call": "off",
		"@typescript-eslint/no-unsafe-return": "off",
		
		// Ban specific types (already handled by @typescript-eslint/recommended)
		"@typescript-eslint/ban-types": "off",

		// ==========================================
		// PHASE 8: IMMUTABILITY & CODE QUALITY
		// ==========================================
		
		// Prevent parameter reassignment (common source of bugs)
		"no-param-reassign": [
			"error",
			{
				"props": true,
				"ignorePropertyModificationsFor": [
					"acc",
					"accumulator",
					"e",
					"ctx",
					"context",
					"req",
					"request",
					"res",
					"response",
					"$scope",
					"staticContext",
					"state"
				]
			}
		],
		
		// Prefer object spread over Object.assign
		"prefer-object-spread": "error",
		
		// Prefer destructuring from arrays/objects
		"prefer-destructuring": [
			"warn",
			{
				"VariableDeclarator": {
					"array": false,
					"object": true
				},
				"AssignmentExpression": {
					"array": false,
					"object": false
				}
			},
			{
				"enforceForRenamedProperties": false
			}
		],
		
		// Prevent duplicate imports
		"import/no-duplicates": [
			"error",
			{
				"considerQueryString": true,
				"prefer-inline": false
			}
		],

		// ==========================================
		// PHASE 8: REACT PERFORMANCE & BEST PRACTICES
		// ==========================================
		
		// React settings
		"react/react-in-jsx-scope": "off",
		"react/prop-types": "off",
		
		// Require keys in list rendering
		"react/jsx-key": [
			"error",
			{
				"checkFragmentShorthand": true,
				"checkKeyMustBeforeSpread": true,
				"warnOnDuplicates": true
			}
		],
		
		// Prevent usage of dangerous properties
		"react/no-danger": "warn",
		
		// Prevent unused prop types
		"react/no-unused-prop-types": [
			"warn",
			{
				"customValidators": [],
				"skipShapeProps": true
			}
		],
		
		// Enforce React Hooks rules
		"react-hooks/rules-of-hooks": "error",
		"react-hooks/exhaustive-deps": [
			"warn",
			{
				"additionalHooks": "(useFormSubmit|useCRUDSubmit|useServerTable)"
			}
		],
		
		// Prevent direct mutation of state
		"react/no-direct-mutation-state": "error",
		
		// Prevent using deprecated React methods
		"react/no-deprecated": "error",
		
		// Prevent using findDOMNode
		"react/no-find-dom-node": "error",
		
		// Prevent using string refs
		"react/no-string-refs": "error",

		// ==========================================
		// PHASE 8: ACCESSIBILITY (WCAG 2.1 AA)
		// ==========================================
		
		"jsx-a11y/alt-text": "error",
		"jsx-a11y/anchor-has-content": "error",
		"jsx-a11y/anchor-is-valid": "error",
		"jsx-a11y/aria-props": "error",
		"jsx-a11y/aria-proptypes": "error",
		"jsx-a11y/aria-unsupported-elements": "error",
		"jsx-a11y/click-events-have-key-events": "warn",
		"jsx-a11y/heading-has-content": "error",
		"jsx-a11y/iframe-has-title": "error",
		"jsx-a11y/img-redundant-alt": "warn",
		"jsx-a11y/interactive-supports-focus": "warn",
		"jsx-a11y/label-has-associated-control": [
			"error",
			{
				"required": {
					"some": ["nesting", "id"]
				}
			}
		],
		"jsx-a11y/mouse-events-have-key-events": "warn",
		"jsx-a11y/no-access-key": "error",
		"jsx-a11y/no-autofocus": "warn",
		"jsx-a11y/no-noninteractive-element-interactions": "warn",
		"jsx-a11y/no-redundant-roles": "error",
		"jsx-a11y/role-has-required-aria-props": "error",
		"jsx-a11y/role-supports-aria-props": "error",
		"jsx-a11y/scope": "error",
		"jsx-a11y/tabindex-no-positive": "warn"
	},
	"overrides": [
		{
			// Allow default exports in Next.js specific files
			"files": [
				"app/**/page.tsx",
				"app/**/layout.tsx",
				"app/**/error.tsx",
				"app/**/loading.tsx",
				"app/**/not-found.tsx",
				"app/**/template.tsx",
				"app/**/default.tsx",
				"app/middleware.ts",
				"*.config.*"
			],
			"rules": {
				"import/no-default-export": "off",
				"import/prefer-default-export": "off"
			}
		},
		{
			// Barrel export files: enforce named exports only + no wildcards
			"files": ["**/index.ts", "**/index.tsx"],
			"rules": {
				"import/no-default-export": "error",
				"no-restricted-syntax": [
					"error",
					{
						"selector": "ExportAllDeclaration",
						"message": "‚ùå Wildcard exports (export * from) are FORBIDDEN in barrel files.\n\nüéØ Why?\n  ‚Ä¢ Prevents optimal tree-shaking\n  ‚Ä¢ Makes dependencies unclear\n  ‚Ä¢ Harder to track what's exported\n  ‚Ä¢ Can cause circular dependency issues\n\n‚úÖ Solution:\n  Replace with explicit named exports:\n  export { specificFunction, specificClass } from './module'\n\nüìö FAANG Standard:\n  Google, Meta, Netflix all use explicit exports for enterprise codebases."
					}
				]
			}
		},
		{
			// TypeScript definition files
			"files": ["*.d.ts"],
			"rules": {
				"@typescript-eslint/no-explicit-any": "off",
				"import/no-default-export": "off"
			}
		},
		{
			// Test files
			"files": ["**/*.test.ts", "**/*.test.tsx", "**/*.spec.ts", "**/*.spec.tsx"],
			"rules": {
				"@typescript-eslint/no-explicit-any": "off",
				"no-console": "off"
			}
		},
		{
			// Domain classes: Allow circular dependencies for bidirectional relationships
			// Company <-> Order, Company <-> User, User <-> Company, Order <-> Company
			// These are intentional and necessary for domain model deep copy/hydration patterns
			"files": [
				"app/_classes/Company.ts",
				"app/_classes/User.ts",
				"app/_classes/Order.ts",
				"app/_classes/Quote.ts"
			],
			"rules": {
				"import/no-cycle": "warn"
			}
		},
		{
			// Logger types: Allow ILogger interface (legacy naming)
			"files": ["app/_core/logger/types.ts"],
			"rules": {
				"@typescript-eslint/naming-convention": "off"
			}
		},
		{
			// Service Worker: Allow special patterns
			"files": ["app/_components/common/ServiceWorkerRegistration.tsx"],
			"rules": {
				"@typescript-eslint/no-floating-promises": "off"
			}
		}
	]
}
